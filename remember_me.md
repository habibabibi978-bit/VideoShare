# Tech-app Project - Complete Setup Documentation

This document summarizes the complete setup of the Tech-app video platform project, including both frontend and backend configurations.

## üìÅ Project Structure

```
Desktop/
‚îú‚îÄ‚îÄ frontend/          # React + Vite frontend application
‚îî‚îÄ‚îÄ backend/          # NestJS + TypeScript backend API
```

---

## üéØ Frontend Setup

### Location
`C:\Users\M\Desktop\frontend`

### Technology Stack
- **React 18.3.1** - UI library
- **Vite 5.3.1** - Build tool and dev server
- **Redux Toolkit 2.2.6** - State management
- **React Router DOM 6.24.1** - Client-side routing
- **Tailwind CSS 3.4.4** - Utility-first CSS framework
- **Axios 1.7.2** - HTTP client

### Configuration Files

#### `.env` File Location
`C:\Users\M\Desktop\frontend\.env`

#### Environment Variables
```env
VITE_REACT_APP_BASE_URL=http://localhost:3000/api
VITE_REACT_APP_CLOUD_NAME=your-cloudinary-cloud-name
VITE_REACT_APP_GOOGLE_CLIENT_ID=your-google-client-id
```

#### `vite.config.js` Configuration
```javascript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  server: {
    host: '0.0.0.0', // Listen on all network interfaces
    port: 5173,
    strictPort: false,
  },
})
```

### Key Files
- **API Configuration**: `src/utils/axiosInstance.js` - Configured to use `VITE_REACT_APP_BASE_URL`
- **Main Entry**: `src/main.jsx`
- **App Component**: `src/App.jsx` - Contains routing and protected routes

### Start Frontend
```bash
cd C:\Users\M\Desktop\frontend
npm run dev
```
**URL**: http://localhost:5173

---

## üöÄ Backend Setup

### Location
`C:\Users\M\Desktop\backend`

### Technology Stack
- **NestJS 11.0.1** - Progressive Node.js framework
- **TypeScript** - Type-safe JavaScript
- **MongoDB** - NoSQL database with Mongoose ODM
- **JWT** - Authentication and authorization
- **Passport** - Authentication strategies (JWT, Google OAuth)
- **Cloudinary** - Video and image storage
- **Swagger** - API documentation

### Configuration Files

#### `.env` File Location
`C:\Users\M\Desktop\backend\.env`

#### Environment Variables
```env
# Server Configuration
PORT=3000
NODE_ENV=development
FRONTEND_URL=http://localhost:5173

# Database
MONGODB_URI=mongodb+srv://habibabibi978_db_user:YOUR_PASSWORD@cluster313.pe0p5hr.mongodb.net/tech-app?retryWrites=true&w=majority

# JWT Configuration (Auto-generated secure secrets)
JWT_SECRET=<auto-generated>
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=<auto-generated>
JWT_REFRESH_EXPIRES_IN=30d

# Google OAuth (Optional)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=http://localhost:3000/api/auth/google/callback

# Cloudinary Configuration (Optional)
CLOUDINARY_CLOUD_NAME=your-cloudinary-cloud-name
CLOUDINARY_API_KEY=your-cloudinary-api-key
CLOUDINARY_API_SECRET=your-cloudinary-api-secret

# Email Configuration (Optional)
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-app-password
EMAIL_FROM=noreply@tech-app.com

# Application URL
APP_URL=http://localhost:3000
```

### MongoDB Configuration
- **Database**: MongoDB Atlas (Cloud)
- **Cluster**: cluster313.pe0p5hr.mongodb.net
- **Database Name**: tech-app
- **Connection String**: `mongodb+srv://habibabibi978_db_user:PASSWORD@cluster313.pe0p5hr.mongodb.net/tech-app`

### Project Structure
```
backend/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ auth/              # Authentication module
‚îÇ   ‚îú‚îÄ‚îÄ users/             # User management
‚îÇ   ‚îú‚îÄ‚îÄ videos/            # Video management
‚îÇ   ‚îú‚îÄ‚îÄ comments/           # Comments system
‚îÇ   ‚îú‚îÄ‚îÄ likes/             # Likes/dislikes
‚îÇ   ‚îú‚îÄ‚îÄ subscriptions/     # Subscriptions
‚îÇ   ‚îú‚îÄ‚îÄ notifications/      # Notifications
‚îÇ   ‚îú‚îÄ‚îÄ playlists/         # Playlists
‚îÇ   ‚îú‚îÄ‚îÄ cloudinary/        # Cloudinary service
‚îÇ   ‚îú‚îÄ‚îÄ schemas/           # MongoDB schemas
‚îÇ   ‚îú‚îÄ‚îÄ config/            # Configuration files
‚îÇ   ‚îî‚îÄ‚îÄ main.ts            # Application entry point
‚îú‚îÄ‚îÄ .env                   # Environment variables
‚îî‚îÄ‚îÄ package.json
```

### Start Backend
```bash
cd C:\Users\M\Desktop\backend
npm run start:dev
```
**URL**: http://localhost:3000
**Swagger Docs**: http://localhost:3000/api/docs

---

## üîó Frontend-Backend Connection

### API Configuration
- **Frontend API Base URL**: `http://localhost:3000/api`
- **Backend CORS**: Configured for `http://localhost:5173`
- **Authentication**: JWT tokens stored in localStorage

### Connection Status
‚úÖ Frontend `.env` configured with backend URL
‚úÖ Backend CORS enabled for frontend origin
‚úÖ Axios instance configured with authentication interceptor

---

## üì° API Endpoints

### Authentication
- `POST /api/users/register` - Register new user
- `POST /api/users/login` - Login user
- `GET /api/auth/google` - Google OAuth login
- `GET /api/auth/google/callback` - Google OAuth callback

### Users
- `GET /api/users/current-user` - Get current user (Protected)
- `GET /api/users/c/:username` - Get user profile
- `GET /api/users/c/:username/videos` - Get user videos
- `PATCH /api/users/update-account` - Update account (Protected)
- `POST /api/users/change-password` - Change password (Protected)
- `PATCH /api/users/avatar` - Update avatar (Protected)
- `PATCH /api/users/coverImage` - Update cover image (Protected)
- `GET /api/users/watch-history` - Get watch history (Protected)
- `POST /api/users/update-watch-history` - Update watch history (Protected)
- `DELETE /api/users/watch-history` - Delete watch history (Protected)
- `DELETE /api/users/delete-account` - Delete account (Protected)
- `GET /api/users/verify/:userId/:token` - Verify email

### Videos
- `GET /api/videos` - Get all videos (paginated)
- `GET /api/videos/:id` - Get video by ID
- `GET /api/videos/search?q=query` - Search videos
- `GET /api/videos/related/:id` - Get related videos
- `GET /api/videos/subscribedVideos` - Get subscribed channels videos (Protected)
- `POST /api/videos/upload` - Upload video (Protected)
- `PATCH /api/videos/incrementViewCount/:id` - Increment view count
- `DELETE /api/videos/:id` - Delete video (Protected)

### Comments
- `GET /api/comments/:videoId` - Get video comments
- `POST /api/comments/:videoId` - Create comment (Protected)
- `PUT /api/comments/:id` - Update comment (Protected)
- `DELETE /api/comments/:id` - Delete comment (Protected)

### Likes
- `POST /api/likes/toggle-video-like/:id` - Toggle like (Protected)
- `POST /api/likes/toggle-video-dislike/:id` - Toggle dislike (Protected)
- `GET /api/likes/liked-videos` - Get liked videos (Protected)
- `GET /api/likes/disliked-videos` - Get disliked videos (Protected)

### Subscriptions
- `POST /api/subscription/toggle/:channelId` - Toggle subscription (Protected)
- `GET /api/subscription/subscribed` - Get subscribed channels (Protected)
- `GET /api/subscription/subscribers/:channelId` - Get channel subscribers

### Notifications
- `GET /api/notifications` - Get notifications (Protected)
- `PUT /api/notifications/mark-read` - Mark as read (Protected)

### Playlists
- `GET /api/playlist/:username` - Get user playlists

---

## üóÑÔ∏è Database Schemas

### User Schema
- username, email, fullname, password
- avatar, coverImage, about
- isEmailVerified, emailVerificationToken
- googleId, subscribersCount, videosCount, totalViews

### Video Schema
- owner (User reference), title, description
- videoFile, thumbnail, views, duration
- isPublished, tags

### Comment Schema
- video (Video reference), owner (User reference), content

### Like Schema
- video (Video reference), owner (User reference), type (like/dislike)

### Subscription Schema
- subscriber (User reference), channel (User reference)

### WatchHistory Schema
- user (User reference), video (Video reference)

### Notification Schema
- user (User reference), message, isRead, type, link

### Playlist Schema
- owner (User reference), name, description, videos (Video references)

---

## üîß Development Commands

### Frontend
```bash
cd C:\Users\M\Desktop\frontend
npm install          # Install dependencies
npm run dev          # Start development server
npm run build        # Build for production
npm run preview      # Preview production build
npm run lint         # Run ESLint
```

### Backend
```bash
cd C:\Users\M\Desktop\backend
npm install          # Install dependencies
npm run start:dev    # Start development server
npm run build        # Build for production
npm run start:prod   # Start production server
npm run lint         # Run ESLint
npm run test         # Run tests
```

---

## üêõ Troubleshooting

### Frontend Issues

#### Server not accessible on localhost:5173
- **Solution**: Updated `vite.config.js` to listen on `0.0.0.0`
- **Check**: Verify server is running and check terminal output

#### CORS Errors
- **Solution**: Backend CORS is configured for `http://localhost:5173`
- **Check**: Verify `FRONTEND_URL` in backend `.env`

#### API Connection Errors
- **Solution**: Verify `VITE_REACT_APP_BASE_URL=http://localhost:3000/api` in frontend `.env`
- **Check**: Ensure backend is running on port 3000

### Backend Issues

#### MongoDB Connection Errors
- **Solution**: 
  1. Check MongoDB Atlas Network Access (whitelist IP)
  2. Verify `MONGODB_URI` in `.env` has correct password
  3. Ensure MongoDB Atlas cluster is running

#### TypeScript Compilation Errors
- **Status**: ‚úÖ All fixed
- **Fixes Applied**:
  - JWT type issues resolved with type assertions
  - Response type import fixed (using `import type`)
  - Cloudinary result undefined checks added
  - User service type safety improvements
  - Google OAuth strategy made optional (won't crash if credentials missing)
  - Email transporter made optional (won't crash if email config missing)

#### Optional Service Configuration
- **Status**: ‚úÖ All optional services now handle missing configuration gracefully
- **Fixes Applied**:
  - **Email Service**: Email transporter only initializes if EMAIL_HOST, EMAIL_USER, and EMAIL_PASS are provided
    - Verification emails are skipped with a console warning if not configured
    - Verification URL is logged to console for manual testing
  - **Cloudinary Service**: Checks for configuration before initializing
    - Upload methods throw clear error messages if Cloudinary is not configured
    - Delete operations are skipped with a warning if not configured
  - **Google OAuth**: Made optional - app can start without Google credentials
    - Strategy uses dummy values if credentials are missing (prevents crashes)
    - Clear error messages returned to frontend if Google OAuth is attempted without configuration

#### Port Already in Use
- **Solution**: 
  ```bash
  # Find process using port 3000
  netstat -ano | findstr ":3000"
  # Kill process (replace PID)
  taskkill /PID <PID> /F
  ```

---

## ‚úÖ Setup Checklist

### Frontend
- [x] Dependencies installed
- [x] `.env` file created with API URL
- [x] `vite.config.js` configured for network access
- [x] Axios instance configured
- [x] Development server can start

### Backend
- [x] NestJS project initialized
- [x] All dependencies installed
- [x] MongoDB connection configured
- [x] `.env` file created with all variables
- [x] JWT secrets auto-generated
- [x] All modules created (Auth, Users, Videos, Comments, Likes, Subscriptions, Notifications, Playlists)
- [x] Swagger documentation configured
- [x] CORS enabled for frontend
- [x] TypeScript compilation errors fixed
- [x] Server running successfully

### Connection
- [x] Frontend configured to connect to backend
- [x] Backend CORS configured for frontend
- [x] Authentication flow ready

---

## üìù Important Notes

1. **MongoDB Password**: The `.env` file contains the MongoDB password. Keep it secure and never commit to version control.

2. **JWT Secrets**: Auto-generated secure random strings. Keep them secret.

3. **Environment Files**: 
   - Frontend: `C:\Users\M\Desktop\frontend\.env`
   - Backend: `C:\Users\M\Desktop\backend\.env`
   - Both are in `.gitignore` (should not be committed)

4. **Ports**:
   - Frontend: `5173` (Vite default)
   - Backend: `3000` (NestJS default)

5. **Optional Configurations** (can be added later):
   - Cloudinary (for video/image uploads)
   - Google OAuth (for Google sign-in)
   - Email service (for email verification)

---

## üöÄ Quick Start Guide

### First Time Setup
1. **Backend**:
   ```bash
   cd C:\Users\M\Desktop\backend
   # Update .env with MongoDB password
   npm install
   npm run start:dev
   ```

2. **Frontend**:
   ```bash
   cd C:\Users\M\Desktop\frontend
   npm install
   npm run dev
   ```

### Daily Development
1. Start backend: `cd backend && npm run start:dev`
2. Start frontend: `cd frontend && npm run dev`
3. Access:
   - Frontend: http://localhost:5173
   - Backend API: http://localhost:3000/api
   - Swagger Docs: http://localhost:3000/api/docs

---

## üìö Documentation Files

- `FRONTEND.md` - Frontend documentation
- `CONNECTION_GUIDE.md` - Frontend-backend connection guide
- `backend/README.md` - Backend documentation
- `backend/TESTING_GUIDE.md` - Backend testing guide
- `backend/MONGODB_SETUP.md` - MongoDB setup guide

---

## üéØ Project Status

**Status**: ‚úÖ Fully Configured and Ready for Development

- ‚úÖ Frontend setup complete
- ‚úÖ Backend setup complete
- ‚úÖ Database connected
- ‚úÖ API endpoints implemented
- ‚úÖ Authentication system ready
- ‚úÖ Frontend-backend connection configured

**Next Steps**:
1. Test user registration and login
2. Test video upload (requires Cloudinary setup)
3. Test all features end-to-end
4. Configure optional services (Cloudinary, Google OAuth, Email)

---

**Last Updated**: December 29, 2025
**Project**: Tech-app Video Platform
**Stack**: React + Vite (Frontend) | NestJS + TypeScript + MongoDB (Backend)

